import{_ as k,L as x,m as T,e as L,T as p,r as _,o as a,c as l,b as B,a as t,E as v,v as D,x as q,F as b,A,B as n,D as d,G as C,s as g,C as I,z as y}from"./index-UaBsPtZV.js";import{c as m}from"./cartStore-Kvj5j6H9.js";import"./axios-L6U4YIEh.js";const V={data(){return{isLoading:!1,couponCode:"",toastBody:null,toastClass:"",defaultCouponValue:0}},components:{Loading:x},computed:{...T(m,["cart","final_total","total","discount","showToast","refreshDiscount","loading"])},watch:{loading(s){this.isLoading=s},showToast(s){s==="已套用優惠券"&&this.onToastCalled()}},methods:{...L(m,["getCart","removeCartItem","changeCartQty","applyDiscount","resetShowToast","deleteCart"]),applyCoupon(){this.applyDiscount(this.couponCode)},onToastCalled(){this.showToast==="已套用優惠券"?(this.couponCode==="Reading"&&(this.toastClass="text-bg-info"),this.couponCode==="Literature"&&(this.toastClass="text-bg-primary"),this.toastBody.show()):(this.toastClass="text-bg-danger",this.invalidToast.show()),this.resetShowToast()},removeAllItems(){this.isLoading=this.loading,this.deleteCart()}},mounted(){this.getCart();const s=this.$refs.toast,e=this.$refs.invalidToast;this.toastBody=new p(s),this.invalidToast=new p(e),this.$watch("showToast",r=>{r&&this.onToastCalled()})}},S={class:"container mt-4"},E={"aria-live":"polite","aria-atomic":"true",class:"position-fixed top-0 end-0 p-3",style:{"z-index":"11"}},$={ref:"toast",class:"toast",role:"alert","aria-live":"assertive","aria-atomic":"true"},N={ref:"invalidToast",class:"toast",role:"alert","aria-live":"assertive","aria-atomic":"true"},Q={class:"row mb-3"},R={class:"col-12"},z=t("label",{for:"couponCode"},"Coupon Code:",-1),M=t("div",{class:"alert alert-info mt-2"},"Code: Reading",-1),P=t("div",{class:"alert alert-primary mt-2"},"Code: Literature",-1),U={class:"row"},F={class:"col-12"},Y={class:"table-responsive"},j={class:"table table-hover"},G=t("thead",null,[t("tr",null,[t("th",{scope:"col",style:{width:"50px"}},"#"),t("th",{scope:"col"},"Item"),t("th",{scope:"col"},"Price"),t("th",{scope:"col",style:{width:"120px"}},"Quantity"),t("th",{scope:"col"},"Total"),t("th",{scope:"col",style:{width:"100px"}},"Remove")])],-1),X={key:0},H={scope:"row"},J={class:"row"},K={class:"col-md-3"},O=["src"],W={class:"col-md-9"},Z={class:"text-muted"},tt={class:"btn-group",role:"group"},ot=["onClick"],st=["value"],et=["onClick"],at=["onClick"],lt={key:1},nt=t("tr",null,[t("td",{colspan:"6",class:"text-center text-danger"}," There is nothing in the cart! ")],-1),it=[nt],ct=t("td",{colspan:"4",class:"text-right font-weight-bold subtotal-total-label"}," Subtotal: ",-1),dt={colspan:"2",class:"text-right subtotal-total-value"},rt=t("td",{colspan:"4",class:"text-right font-weight-bold subtotal-total-label"}," Total: ",-1),ut={colspan:"2",class:"text-right font-weight-bold subtotal-total-value"},ht={key:0},pt=t("td",{colspan:"4",class:"text-right font-weight-bold subtotal-total-label"}," Discount: ",-1),_t={colspan:"2",class:"text-right text-success subtotal-total-value"},vt={class:"row mb-3"},bt={class:"col-12 d-flex justify-content-between"};function Ct(s,e,r,gt,i,c){const f=_("loading"),u=_("router-link");return a(),l(b,null,[B(f,{active:i.isLoading,"onUpdate:active":e[0]||(e[0]=o=>i.isLoading=o)},null,8,["active"]),t("div",S,[t("div",E,[t("div",$,[t("div",{class:v(["toast-body",i.toastClass])}," Your coupon has been applied successfully! ",2)],512),t("div",N,[t("div",{class:v(["toast-body",i.toastClass])},"Your coupon is invalid!",2)],512)]),t("div",Q,[t("div",R,[z,D(t("input",{type:"text",id:"couponCode","onUpdate:modelValue":e[1]||(e[1]=o=>i.couponCode=o),placeholder:"Enter coupon code",class:"form-control"},null,512),[[q,i.couponCode]]),M,P,t("button",{class:"btn btn-success mt-2",onClick:e[2]||(e[2]=(...o)=>c.applyCoupon&&c.applyCoupon(...o))}," Apply Coupon ")])]),t("div",U,[t("div",F,[t("div",Y,[t("table",j,[G,s.cart.length>0?(a(),l("tbody",X,[(a(!0),l(b,null,A(s.cart,(o,w)=>(a(),l("tr",{key:o.id},[t("th",H,n(w+1),1),t("td",null,[t("div",J,[t("div",K,[t("img",{src:o.product.imageUrl,class:"img-fluid",alt:"Item"},null,8,O)]),t("div",W,[t("div",null,n(o.product.title),1),t("div",Z,n(o.product.origin_price),1)])])]),t("td",null,"$"+n(o.product.price),1),t("td",null,[t("div",tt,[o.qty>1?(a(),l("button",{key:0,type:"button",class:"btn btn-secondary",onClick:h=>{o.qty--,s.changeCartQty(o,o.qty)}}," - ",8,ot)):d("",!0),t("input",{type:"text",class:"form-control text-center",value:o.qty,disabled:""},null,8,st),t("button",{type:"button",class:"btn btn-secondary",onClick:h=>{o.qty++,s.changeCartQty(o,o.qty)}}," + ",8,et)])]),t("td",null,"$"+n(o.qty*o.product.price),1),t("td",null,[t("button",{type:"button",class:"btn btn-danger",onClick:h=>s.removeCartItem(o.id)}," X ",8,at)])]))),128))])):(a(),l("tbody",lt,it)),t("tfoot",null,[t("tr",null,[ct,t("td",dt," $"+n(this.total),1)]),t("tr",null,[rt,t("td",ut," $"+n(this.final_total),1)]),this.discount?(a(),l("tr",ht,[pt,t("td",_t," -$ "+n(this.discount===0?this.refreshDiscount:this.discount),1)])):d("",!0)])])])])]),t("div",vt,[t("div",bt,[s.cart.length>0?(a(),C(u,{key:0,to:"/form",class:"btn btn-info"},{default:g(()=>[y("Proceed to Checkout")]),_:1})):(a(),C(u,{key:1,to:"/products",class:"btn btn-danger"},{default:g(()=>[y("Browse More Products")]),_:1})),s.cart.length>0?(a(),l("button",{key:2,class:"btn btn-danger",onClick:e[3]||(e[3]=I((...o)=>c.removeAllItems&&c.removeAllItems(...o),["prevent"]))}," Remove All ")):d("",!0)])])])],64)}const wt=k(V,[["render",Ct]]);export{wt as default};
