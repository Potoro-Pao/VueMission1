import{a as n}from"./axios-L6U4YIEh.js";import{_ as g,P as C,o as O,c as b,a as e,v as i,S as L,x as c,L as S,r as m,b as p,F as f,A as x,B as u,X as U}from"./index-UaBsPtZV.js";import{D as A}from"./dashboardDelModal-C4yvICFf.js";import{P as $}from"./PaginationComponent-RZ82A6UM.js";const k={props:["selectedOrder","tempProduct","updateProduct"],computed:{paymentStatusComputed:{get(){return this.editOrder.is_paid?"true":"false"},set(d){this.editOrder.is_paid=d==="true"}}},data(){return{modalOrder:null,editOrder:{is_paid:Boolean,user:{name:"",email:"",tel:"",address:""}}}},watch:{selectedOrder(){this.editOrder=this.selectedOrder}},methods:{openModal(){this.modalOrder.show()},closeModal(){this.modalOrder.hide()}},mounted(){this.modalOrder=new C(this.$refs.updateOrderModal),this.editOrder=this.selectedOrder}},T={class:"modal fade",ref:"updateOrderModal",tabindex:"-1","aria-labelledby":"updateOrderInfoModalLabel","aria-hidden":"true"},w={class:"modal-dialog"},E={class:"modal-content"},I=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"updateOrderInfoModalLabel"}," Update Order Information "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),B={class:"modal-body"},R={class:"mb-3"},N=e("label",{for:"paymentStatus",class:"form-label"},"Payment Status",-1),z=e("option",{value:"true"},"Paid",-1),F=e("option",{value:"false"},"Unpaid",-1),W=[z,F],X={class:"mb-3"},j=e("label",{for:"orderMessage",class:"form-label"},"Message",-1),q={class:"mb-3"},G=e("label",{for:"userName",class:"form-label"},"Name",-1),H={class:"mb-3"},J=e("label",{for:"userEmail",class:"form-label"},"Email",-1),K={class:"mb-3"},Q=e("label",{for:"userTel",class:"form-label"},"Telephone",-1),Y={class:"mb-3"},Z=e("label",{for:"userAddress",class:"form-label"},"Address",-1),ee={class:"modal-footer"},te=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);function se(d,t,a,v,s,l){return O(),b("div",T,[e("div",w,[e("div",E,[I,e("div",B,[e("div",R,[N,i(e("select",{id:"paymentStatus",class:"form-select","onUpdate:modelValue":t[0]||(t[0]=o=>l.paymentStatusComputed=o)},W,512),[[L,l.paymentStatusComputed]])]),e("div",X,[j,i(e("textarea",{id:"orderMessage",class:"form-control",rows:"2","onUpdate:modelValue":t[1]||(t[1]=o=>s.editOrder.message=o)},null,512),[[c,s.editOrder.message]])]),e("div",q,[G,i(e("input",{type:"text",id:"userName",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=o=>s.editOrder.user.name=o)},null,512),[[c,s.editOrder.user.name]])]),e("div",H,[J,i(e("input",{type:"email",id:"userEmail",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=o=>s.editOrder.user.email=o)},null,512),[[c,s.editOrder.user.email]])]),e("div",K,[Q,i(e("input",{type:"tel",id:"userTel",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=o=>s.editOrder.user.tel=o)},null,512),[[c,s.editOrder.user.tel]])]),e("div",Y,[Z,i(e("input",{type:"text",id:"userAddress",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=o=>s.editOrder.user.address=o)},null,512),[[c,s.editOrder.user.address]])])]),e("div",ee,[te,e("button",{type:"button",class:"btn btn-primary",onClick:t[6]||(t[6]=(...o)=>a.updateProduct&&a.updateProduct(...o))}," Update ")])])])],512)}const de=g(k,[["render",se]]);var oe={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_API:"potoro",BASE_URL:"/VueMission1/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:_,VITE_API:h}=oe,re={data(){return{isLoading:!1,orders:[],modal:null,selectedOrder:{is_paid:Boolean,user:{name:"",email:"",tel:"",address:""}},tempProduct:{},pages:{}}},components:{DDM:A,DOM:de,PagC:$,Loading:S},methods:{removeAllOrders(){this.isLoading=!0;const d=`${_}/api/${h}/admin/orders/all`;n.delete(d).then(()=>{this.isLoading=!1,this.getOrders()}).catch(()=>{})},prepareDeleteOrder(d){this.tempProduct.id=d,this.$refs.dModal.openDeleteModal()},deleteOrder(){const d=`${_}/api/${h}/admin/order/${this.tempProduct.id}`;n.delete(d).then(()=>{this.getOrders(),this.$refs.dModal.closeDeleteModal()}).catch(()=>{})},getOrders(d=1){const t=`${_}/api/${h}/admin/orders?page=${d}`;n.get(t).then(a=>{this.orders=a.data.orders,this.pages=a.data.pagination})},showOrderDetail(d){this.selectedOrder=this.orders.find(t=>t.id===d.id),this.$refs.dOrderModal.openModal()},updateProduct(){const d=`${_}/api/${h}/admin/order/${this.selectedOrder.id}`;n.put(d,{data:this.selectedOrder}).then(t=>{this.products=t.data.products,this.getOrders(),this.$refs.dOrderModal.closeModal()}).catch(()=>{})}},mounted(){const d=document.cookie.replace(/(?:(?:^|.*;\s*)hexVueToken\s*=\s*([^;]*).*$)|^.*$/,"$1");n.defaults.headers.common.Authorization=d,this.getOrders()}},le={class:"container mt-5"},ae=e("h2",null,"Order List",-1),ie={class:"table-responsive"},ne={class:"text-end mb-5"},ce={class:"table"},ue=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Order ID"),e("th",{scope:"col"},"Created Time"),e("th",{scope:"col"},"Total Amount"),e("th",{scope:"col"},"Payment Status"),e("th",{scope:"col"},"Operation")])],-1),me={scope:"row"},pe=["onClick"],_e=["onClick"];function he(d,t,a,v,s,l){const o=m("loading"),M=m("PagC"),y=m("DOM"),D=m("DDM");return O(),b(f,null,[p(o,{active:s.isLoading,"onUpdate:active":t[0]||(t[0]=r=>s.isLoading=r)},null,8,["active"]),e("div",le,[ae,e("div",ie,[e("div",ne,[e("button",{onClick:t[1]||(t[1]=(...r)=>l.removeAllOrders&&l.removeAllOrders(...r)),class:"btn btn-danger"}," Remove All Orders ")]),e("table",ce,[ue,e("tbody",null,[(O(!0),b(f,null,x(s.orders,(r,P)=>(O(),b("tr",{key:r.id},[e("th",me,u(P+1),1),e("td",null,u(r.id),1),e("td",null,u(new Date(r.create_at*1e3).toLocaleDateString("zh-TW")),1),e("td",null,"$ "+u(Math.round(r.total)),1),e("td",{style:U({color:r.is_paid?"green":"red"})},u(r.is_paid?"Paid":"Unpaid"),5),e("td",null,[e("button",{type:"button",class:"btn btn-primary",onClick:V=>l.showOrderDetail(r)}," View Detail ",8,pe),e("button",{type:"button",class:"btn btn-danger",onClick:V=>l.prepareDeleteOrder(r.id)}," Delete ",8,_e)])]))),128))])])]),p(M,{pages:s.pages,getProduct:l.getOrders,basePath:"/admin"},null,8,["pages","getProduct"])]),p(y,{"temp-product":s.tempProduct,"selected-order":s.selectedOrder,"update-product":l.updateProduct,ref:"dOrderModal"},null,8,["temp-product","selected-order","update-product"]),p(D,{"selected-order":s.selectedOrder,"delete-product":l.deleteOrder,ref:"dModal"},null,8,["selected-order","delete-product"])],64)}const ve=g(re,[["render",he]]);export{ve as default};
