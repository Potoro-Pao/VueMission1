import{U as h}from"./index-UaBsPtZV.js";import{a as o}from"./axios-L6U4YIEh.js";var n={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_API:"potoro",BASE_URL:"/VueMission1/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:i,VITE_API:s}=n,l=h("cartStore",{state:()=>({cart:[],final_total:0,total:0,discount:0,showToast:"",loading:!1}),actions:{getCart(){const t=`${i}/api/${s}/cart`;o.get(t).then(a=>{this.cart=a.data.data.carts,this.final_total=Math.floor(a.data.data.final_total),this.total=a.data.data.total,this.discount=this.final_total-this.total})},addToCart(t,a=1){const e=`${i}/api/${s}/cart`,r={product_id:t,qty:a};o.post(e,{data:r}).then(()=>{this.getCart()})},removeCartItem(t){o.delete(`${i}/api/${s}/cart/${t}`).then(()=>{this.getCart()})},deleteCart(){this.loading=!0;const t=`${i}/api/${s}/carts`;o.delete(t).then(()=>{this.loading=!1,this.deleteCartPinia()})},changeCartQty(t,a=1){const e={product_id:t.product_id,qty:a};o.put(`${i}/api/${s}/cart/${t.id}`,{data:e}).then(()=>{this.getCart()})},deleteCartPinia(){this.getCart()},resetShowToast(){this.showToast=""},applyDiscount(t){const a={data:{code:t}},e=`${i}/api/${s}/coupon`;o.post(e,a).then(r=>{this.final_total=Math.floor(r.data.data.final_total),this.discount=Math.floor(Math.abs(this.final_total-this.total)),this.showToast="已套用優惠券"}).catch(()=>{this.showToast=+Math.random()})}}});export{l as c};
