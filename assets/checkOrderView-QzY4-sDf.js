import{_ as I,L as v,e as O,r as g,o as l,c as h,b as k,a as t,v as u,x as y,F as D,A as x,B as i,S as b,t as C,u as S}from"./index-UaBsPtZV.js";import{a as p}from"./axios-L6U4YIEh.js";import{m as P}from"./mapStore-MEHRQLsi.js";var L={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_API:"potoro",BASE_URL:"/VueMission1/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:_,VITE_API:m}=L,M={data(){return{is_paid:!1,selectedPaymentMethod:"",isLoading:!0,checkoutData:{},orderData:{},productDetails:{},userData:{},orders:{},ordersTotal:0,checkoutOrderID:"",orderID:"",userCountryCity:{country:"",city:""}}},components:{Loading:v},methods:{...O(P,["setLocationFromExternal","setBookPhotoFromExternal"]),confirmOrder(){const o=`${_}/api/${m}/pay/${this.orderID}`;p.post(o).then(()=>{this.isLoading=!0;const s=this.randomPhoto(this.orders);this.setLocationFromExternal(this.userCountryCity,s[0],s[1]),this.$router.push("/success")}).catch(()=>{})},randomPhoto(o){const s=Object.keys(o),d=Math.floor(Math.random()*s.length),n=s[d],r=o[n].product.title,c=o[n].product.imageUrl;return[r,c]},getOrderAll(){const o=`${_}/api/${m}/orders`;p.get(o).then(s=>{this.isLoading=!1,this.orders=s.data.orders,this.is_paid=this.orders[0].is_paid;const d=this.orders.find(n=>n.id===(this.checkoutData.orderId||this.checkoutData.id));d&&(this.orders=d.products,this.ordersTotal=Math.round(d.total),this.orderID=d.id,this.userData=d.user,this.userCountryCity.country=JSON.parse(this.userData.address).country,this.userCountryCity.city=JSON.parse(this.userData.address).city,this.userData.address=JSON.parse(this.userData.address).address)}).catch(()=>{})},searchOrder(){const o=`${_}/api/${m}/order/${this.orderID}`;p.get(o).then(s=>{this.isLoading=!1,this.orders=s.data.order.products,this.userData=s.data.order.user,this.userCountryCity.country=JSON.parse(this.userData.address).country,this.userCountryCity.city=JSON.parse(this.userData.address).city,this.userData.address=JSON.parse(this.orders.address).address,this.ordersTotal=Math.round(s.data.order.total),this.checkoutOrderID=s.data.order.id,this.orderID=s.data.order.id})}},created(){this.$route.query.data&&(this.checkoutData=JSON.parse(this.$route.query.data))},mounted(){this.isLoading=!1,this.checkoutOrderID=this.checkoutData.orderId||this.checkoutData.id,this.orderID=this.checkoutData.orderId||this.checkoutData.id,this.getOrderAll()}},a=o=>(C("data-v-cada31c8"),o=o(),S(),o),E={class:"container"},V=a(()=>t("h1",{class:"text-center my-5"},"Confirm Your Payment",-1)),T={class:"row"},N={class:"mb-3"},U=a(()=>t("label",{style:{"font-size":"20px"},for:"orderId",class:"form-label mb-3"},"Order ID",-1)),A=a(()=>t("label",{style:{"font-size":"20px"},for:"orderId",class:"form-label mb-3"},"Search Order ID",-1)),B={class:"row"},J={class:"card"},w=["src"],F={class:"card-body"},R={class:"card-title"},q={class:"container"},z={class:"card-text"},Y={class:"container"},j={class:"card"},Q={class:"card-body"},$=a(()=>t("h5",{class:"card-title"},[t("strong",null,"Customer Information ")],-1)),G={class:"card-text"},H={class:"card-text"},K={class:"card-text"},W={class:"card-text"},X={class:"card-text text-success"},Z={key:0,class:"mt-3"},tt=a(()=>t("label",{for:"paymentMethod",class:"form-label"},"Payment Methods",-1)),st=a(()=>t("option",{disabled:"",value:""},"Choose a payment method",-1)),et=a(()=>t("option",null,"Credit card",-1)),ot=a(()=>t("option",null,"Bank transfer",-1)),rt=a(()=>t("option",null,"Pay when you get it (Cash on Delivery)",-1)),at=[st,et,ot,rt],dt=["disabled"],it={key:1},ct=a(()=>t("p",{class:"text-danger",style:{"font-size":"30px"}}," Your shipment is on the road. ",-1)),nt=[ct];function lt(o,s,d,n,r,c){const f=g("loading");return l(),h(D,null,[k(f,{active:r.isLoading,"onUpdate:active":s[0]||(s[0]=e=>r.isLoading=e)},null,8,["active"]),t("div",E,[V,t("div",T,[t("div",N,[U,u(t("input",{type:"text",class:"form-control",id:"orderId","onUpdate:modelValue":s[1]||(s[1]=e=>r.checkoutOrderID=e),readonly:""},null,512),[[y,r.checkoutOrderID]]),A,u(t("input",{type:"text",class:"form-control",id:"orderId","onUpdate:modelValue":s[2]||(s[2]=e=>r.orderID=e)},null,512),[[y,r.orderID]]),t("button",{class:"btn btn-primary mt-3",onClick:s[3]||(s[3]=(...e)=>c.searchOrder&&c.searchOrder(...e))}," Search ")]),t("div",B,[(l(!0),h(D,null,x(r.orders,e=>(l(),h("div",{class:"col-md-6",key:e.id},[t("div",J,[t("img",{src:e.product.imageUrl,class:"card-img-top",alt:"Product Image"},null,8,w),t("div",F,[t("h5",R,i(e.product.title),1)]),t("div",q,[t("p",z,"Price: "+i(e.product.price),1),t("p",null,"Quantity: "+i(e.qty),1)])])]))),128))]),t("div",Y,[t("div",j,[t("div",Q,[$,t("p",G,"Name: "+i(this.userData.name),1),t("p",H,"Email: "+i(this.userData.email),1),t("p",K,"Address: "+i(this.userData.address),1),t("p",W,"Phone: "+i(this.userData.tel),1),t("p",X,"Total: "+i(this.ordersTotal),1)])]),this.is_paid?(l(),h("div",it,nt)):(l(),h("div",Z,[tt,u(t("select",{class:"form-select",id:"paymentMethod","onUpdate:modelValue":s[4]||(s[4]=e=>r.selectedPaymentMethod=e)},at,512),[[b,r.selectedPaymentMethod]]),t("button",{class:"btn btn-primary mt-3",disabled:!r.selectedPaymentMethod,onClick:s[5]||(s[5]=(...e)=>c.confirmOrder&&c.confirmOrder(...e))}," Confirm Payment ",8,dt)]))])])])],64)}const _t=I(M,[["render",lt],["__scopeId","data-v-cada31c8"]]);export{_t as default};
