import{U as n}from"./index-UaBsPtZV.js";import{a as e}from"./axios-L6U4YIEh.js";var l={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_API:"potoro",BASE_URL:"/VueMission1/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:c,VITE_API:u}=l,p=n("mapStore",{state:()=>({country:null,city:null,latitude:null,longitude:null,bookPhoto:null,bookTitle:null,products:null,useExternalLocation:!1}),actions:{updateLocation({country:t,city:o,latitude:a,longitude:s}){this.country=t,this.city=o,this.latitude=a,this.longitude=s},async getRandom(){try{this.products||await this.getProducts(),this.getRandomBooks();const t=await e.get("https://randomuser.me/api/");if(t.data&&t.data.results&&t.data.results.length>0){const{country:o,city:a}=t.data.results[0].location;await this.getCountryCoordinates(o,a)}}catch{}},async getCountryCoordinates(t,o){const a=`https://nominatim.openstreetmap.org/search?country=${t}&city=${o}&format=json&limit=1`;try{const s=await e.get(a);if(s.data&&s.data.length>0){const{lat:i,lon:r}=s.data[0];this.updateLocation({country:t,city:o,latitude:parseFloat(i),longitude:parseFloat(r)})}}catch{}},async getProducts(){try{const t=`${c}/api/${u}/products/all`,o=await e.get(t);this.products=o.data.products}catch{this.products=[]}},async setLocationFromExternal({country:t,city:o},a,s){this.useExternalLocation=!0,this.country=t,this.city=o,await this.setBookPhoto(a,s),await this.getCountryCoordinates(t,o),await this.getCountryCoordinates(t,o)},async setBookPhoto(t,o){this.bookTitle=t,this.bookPhoto=o},resetuseExternalLocation(){setTimeout(()=>{this.useExternalLocation=!1},500)},getRandomBooks(){if(this.products&&this.products.length>0){const t=Math.floor(Math.random()*this.products.length);this.bookPhoto=this.products[t].imageUrl,this.bookTitle=this.products[t].title}}}});export{p as m};
